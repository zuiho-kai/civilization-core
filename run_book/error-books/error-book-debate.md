# 错题本 — 🏗️ 架构师 / ⚖️ 讨论专家

> 讨论流程、方案设计相关的典型错误。

### 记录规则

- **条目只写核心规则**（❌/✅/一句话解释），控制在 5 行以内
- **实际案例**最多 2-3 行摘要，详细复盘放独立 postmortem 文件并附链接

---

### DEBATE-1 打包讨论多个议题

❌ 一次讨论同时讨论"前端框架选型"和"后端框架选型"
✅ 拆成两次独立讨论，各自记录结果
> 不同维度的决策必须独立，捆绑讨论导致决策质量下降。

### DEBATE-2 方案只有抽象设计没有落地细节

❌
```
方案A：采用事件驱动架构，实现高度解耦
```

✅
```
方案A：采用事件驱动架构
- 技术选型：FastAPI + WebSocket
- 核心代码：EventBus 类，约50行
- 实现路径：先实现消息广播，再加事件过滤
```
> 方案必须包含技术细节和实现路径，不能只有哲学。

### DEBATE-3 讨论只记录结果不记录过程

❌ discussions.md 只写"最终选择：方案C"
✅ 详细文件记录每轮观点、建议、回应、方案演变过程
> 过程是未来复盘和调整的依据。

### DEBATE-4 决策没有记录被否决方案

❌
```markdown
决策：采用 FastAPI
```

✅
```markdown
决策：采用 FastAPI（3:0 全票）
被否决：Django（生态重、启动慢）、Go（AI生态弱）
```
> 记录为什么不选，避免未来重复讨论。

### DEBATE-5 技术选型只评估功能，不列隐含约束

❌ 选型讨论只比较"SQLite 轻量 vs PostgreSQL 重"，结论写"选 SQLite"就结束
✅ 选型结论必须附带**约束清单**：该技术在本项目场景下的并发限制、必要配置、已知坑
> 每个技术选型都有隐含约束。如果架构师不主动挖掘并写入文档，下游（TDD/Review/测试）全部会默认"没问题"。

**约束清单模板**:
```markdown
## 技术选型约束 — [技术名]
- 并发限制: [如 SQLite 单 writer，必须 BEGIN IMMEDIATE]
- 必要配置: [如 WAL + busy_timeout + isolation_level=None]
- 已知坑: [如 aiosqlite 后台线程执行，asyncio.Lock 无效]
- 测试要求: [如 必须有 2-3 个 async task 并发写入的测试用例]
```

**实际案例**（DEV-BUG-7，详见 COMMON-8）：架构讨论选 SQLite 时只考虑了"轻量、无需额外服务"，没有列出 BEGIN IMMEDIATE 等并发约束，导致全链路漏检。

# Cat Café 项目经验参考

> **来源**: [cat-cafe-tutorials](https://github.com/zts212653/cat-cafe-tutorials)
> **日期**: 2026-02-15
> **性质**: 从外部项目提炼的可借鉴经验，作为项目参考路线

---

## 一、AI 弱点驱动的规则设计（元规则思路）

Cat Café 的核心方法论：**不是"别人怎么做"，而是"AI 会在这里出什么问题，所以我们这样约束"。**

| AI 弱点 | 会导致的问题 | 对策规则 |
|---------|-------------|---------|
| 幻觉 | 编造不存在的信息，格式还很专业 | "不确定就提问，不要硬猜" |
| 讨好倾向 | Review 只说 "looks good" | "Review 必须铁面无私，按 P1/P2/P3 分级" |
| 缺乏持久记忆 | 交接信息丢失，接手方不知道 WHY | "交接必须写 WHY" |
| 过度自信 | 自己判断"改对了"就合入 | "合入前必须经 reviewer 确认" |

### 我们可以怎么用

- **Agent 人格 system prompt**：给每个 Agent 加类似约束，比如"信息不足时明确说不知道"
- **Agent 间协作**：当 Agent 互相 review 悬赏任务成果时，可以用 P1/P2/P3 分级
- **唤醒引擎**：小模型选人时，如果置信度不够应该"不唤醒"而不是随便选一个

---

## 二、交接五件套

Cat Café 要求所有 Agent 间交接必须包含：

| # | 项目 | 说明 |
|---|------|------|
| 1 | What | 具体做了什么 |
| 2 | Why | 为什么这样做（最重要） |
| 3 | Tradeoff | 放弃了什么方案 |
| 4 | Open Questions | 不确定的点 |
| 5 | Next Action | 希望对方做什么 |

### 我们可以怎么用

- **悬赏任务交付**：Agent 完成悬赏后，交付报告可以参考这个格式
- **Agent 协作消息**：Agent A @Agent B 请求协作时，消息结构可以参考
- **记忆系统**：长期记忆中的"项目经验总结记忆"可以用这个格式存储

---

## 三、P1/P2/P3 分级标准

| 级别 | 定义 | 处理方式 |
|------|------|----------|
| P1 | 阻断级：功能错误或安全问题 | 必须立即修 |
| P2 | 重要：质量问题、覆盖不足 | 必须修完才能放行 |
| P3 | 建议：风格、命名、可以更好 | 可以登记 BACKLOG |

### 我们可以怎么用

- **悬赏任务验收**：人类验收 Agent 的悬赏成果时，用 P1/P2/P3 判定是否通过
- **Agent 自检**：Agent 完成任务后自检，P1 问题必须自己修完再提交

---

## 四、禁止表演性同意

Cat Café 发现 AI 收到 review 反馈时会"表演性同意"：

```
❌ "You're absolutely right! Great point! Thanks for catching that!"
   （然后改得不对，因为根本没理解问题）

✅ 直接开始修复（行动 > 言语）
✅ 复述技术问题（证明理解了）
✅ 问澄清问题（如果不理解）
```

### 我们可以怎么用

- **Agent 人格约束**：在 system prompt 中加入"收到反馈时直接行动，不要空洞感谢"
- **闲聊质量**：Agent 闲聊时也应该有实质内容，不要只是附和

---

## 五、CLI 工程化经验（备忘）

虽然我们不采用 CLI 子进程架构，但如果未来需要调用外部 CLI 工具，这些经验值得记住：

1. **stderr 也是活跃信号**：CLI 在 thinking/工具调用时输出到 stderr，只监听 stdout 会误判超时
2. **NDJSON 流边界处理**：粘包、不完整行、编码问题都要处理
3. **超时不要拍脑袋**：根据任务复杂度动态调整，或用心跳机制替代固定超时
4. **进程池优化**：如果频繁 spawn，考虑进程池减少启动开销
5. **开发/生产数据隔离**：Cat Café 因为重启 Redis 丢了辩论冠军记录，教训深刻

---

## 六、SDK vs CLI 选型速查

如果未来需要集成新的 AI 服务，参考这个决策树：

```
需要用订阅额度？
  ├── 是 → 只能走 CLI（CLI 内置 OAuth）
  └── 否 → 用 API key
        ├── 需要完整 Agent 能力（文件操作/命令执行）？
        │     ├── 有 Agent SDK → 用 SDK
        │     └── 无 Agent SDK → 走 CLI
        └── 只需要聊天能力 → 用普通 Chat API
```

---

## 关联文档

- [架构对比讨论](../discussions/2026-02-15-catcafe-vs-openclaw-architecture.md)
- [Agent 架构方案](../specs/SPEC-001-聊天功能/讨论细节/Agent架构方案.md)
- [PRD](../PRD.md)

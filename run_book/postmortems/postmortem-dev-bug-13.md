# Postmortem DEV-BUG-13: M3 体验问题修复耗时过长（5问题 ~30分钟）

## 背景

用户提出 5 个 M3 体验问题，预期快速修复，实际耗时 ~30 分钟。

## 5 个问题及处理

| # | 问题 | 根因 | 修复 |
|---|------|------|------|
| 1 | 悬赏表单 UI 粗糙 | `--server-rail-bg`（深黑）做背景，shadow 过重，focus 用 outline | 改 `--bg-secondary` + border + `--shadow-sm` + focus border-color 过渡 |
| 2 | Agent dropdown 无搜索 | dropdown 只有列表没有 filter | 顶部加搜索框，自动聚焦，实时过滤，无结果提示 |
| 3 | 购买后背包没显示 | 购买成功后没切 tab | 购买成功 → `setTab('inventory')` 自动切到背包 |
| 4 | 选中颜色丑 + 暗色残留 | UserAvatar 用 Discord 霓虹色；agent-status-dot 硬编码颜色 | 改 civitas 柔和色系；硬编码改主题变量 |
| 5 | Agent 不回消息 | DB 里 model="none"，.env API key 空 | 配置问题，告知用户需配 key |

## 耗时分析

总耗时 ~30 分钟，合理耗时应 ~15 分钟。浪费约 15 分钟。

### 浪费点

1. **空日志反复读**（~5 分钟）：server.log 为空，反复用 Read 读取确认，应第一次为空就跳过
2. **串行排查而非并行**（~5 分钟）：5 个问题逐个排查，应一开始并行启动 Explore agent 查所有相关代码
3. **问题 3 过度排查后端**（~5 分钟）：购买后没切 tab 是纯前端 UX 问题，不需要读后端购买 API 代码

### 根因

- 没有先对 5 个问题做分类（前端 UI / 前端逻辑 / 后端 / 配置），直接按顺序逐个处理
- 对"购买后背包没显示"默认假设是后端 bug，没有先验证前端流程

## 教训

1. **多问题批量修复先分类再并行**：拿到多个问题后，先花 1 分钟分类（纯 CSS / 前端逻辑 / 后端 / 配置），同类问题并行处理
2. **空文件/空日志只读一次**：第一次为空就标记跳过，不要反复确认
3. **UX 问题先看前端流程**：用户说"操作后没反应"，先检查前端状态流转（tab 切换、数据刷新），再怀疑后端

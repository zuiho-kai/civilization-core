# 决策分级授权矩阵

> 试点版本 v0.1 — 2026-02-21 起生效，下个里程碑验证后再迭代

## 三级定义

| 级别 | 名称 | 决策权 | 用户参与 |
|------|------|--------|----------|
| L1 | 用户决策 | 用户亲自拍板 | 必须等待用户确认后才能继续 |
| L2 | AI 自主 + 通知 | AI 团队自主决策 | 决策完成后发送通知摘要，用户可异步审阅 |
| L3 | AI 全自主 | AI 团队自主决策 | 不通知，有 checklist/流程兜底 |

## 决策点分级

| # | 决策点 | 级别 | 当前流程文件 | 说明 |
|---|--------|------|-------------|------|
| 1 | 里程碑方向/范围拍板 | L1 | checklist-milestone-gate.md | 产品方向，不可逆 |
| 2 | IR 最终确认 | L1 | checklist-milestone-gate.md | 功能定义，影响全局 |
| 3 | 上线验收（ST 后放行） | L1 | checklist-st.md | 质量门禁，用户体验直接相关 |
| 4 | 五方评审非全票分歧仲裁 | L1 | checklist-milestone-gate.md | 团队无法达成共识，需人类裁决 |
| 5 | SR 评审确认 | L2 | checklist-milestone-gate.md | AI 团队自主评审，通知结论 |
| 6 | AR 评审确认 | L2 | （AR 独立文件） | AI 团队自主评审，通知结论 |
| 7 | CR P2 处置决策 | L2 | CLAUDE.md Phase 完成门禁 | AI 团队自主处置，通知结果 |
| 8 | 五方评审全票共识项 | L2 | checklist-milestone-gate.md | 团队已达成共识，通知即可 |
| 9 | 测试用例设计 | L3 | checklist-st.md | 有 ST checklist 兜底 |
| 10 | 代码实现细节 | L3 | checklist-code-change.md | 有 code change checklist 兜底 |
| 11 | CR P0/P1 修复 | L3 | CLAUDE.md Phase 完成门禁 | 必须修，无决策空间 |
| 12 | 错题本落盘 | L3 | checklist-error-landing.md | 有落盘 checklist 兜底 |
| 13 | 进度文件更新 | L3 | PROGRESS_FILES.md | 纯记录，无风险 |

## 升级规则

以下任一条件触发时，L2/L3 决策自动升级为 L1：

| # | 触发条件 | 示例 |
|---|----------|------|
| 1 | AI 团队内部分歧 2 轮讨论后仍无法收敛 | SR 评审中架构师和技术主管对方案有根本分歧 |
| 2 | 涉及用户明确表态过的偏好或约束 | 用户说过"不用 Redis"，但方案引入了 Redis |
| 3 | 影响范围超出当前里程碑 | 修复一个 bug 需要改动下个里程碑的接口 |
| 4 | 需要新增外部依赖或改变技术栈 | 引入新的 npm 包或 Python 库 |
| 5 | 预估工作量超出原计划 50% 以上 | SR 评估发现实际复杂度远超 IR 预期 |

## L2 通知模板

L2 决策完成后，向用户发送以下格式的通知：

```
📋 [L2 决策通知] {决策点名称}

决策结论：{一句话结论}
关键理由：{为什么这样决定，1-2 句}
影响范围：{涉及哪些文件/模块}
团队共识度：{全票通过 / 多数通过(比例)}

如需调整请告知，否则按此执行。
```

## 试点约束

1. 本文件为试点版本，仅定义分级规则，不修改任何现有流程文件
2. 现有流程文件（checklist-milestone-gate.md、CLAUDE.md 等）在试点验证后再逐个对齐
3. 试点期间如发现分级不合理，随时调整本文件
4. 验证指标：用户实际交互次数对比试点前
